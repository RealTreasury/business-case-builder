!function(e){"use strict";e(document).ready(function(){const r=e("#rtbcb-generate-real-treasury-overview"),t=e("#rtbcb-clear-real-treasury-overview"),c=e("#rtbcb-real-treasury-overview-results"),n=e("#rtbcb-real-treasury-overview-card"),a=e("#rtbcb-include-portal"),o=e("#rtbcb-vendor-categories"),i=e("#rtbcb-override-categories"),s=e("#rtbcb-company-summary"),l=e("#rtbcb-company-challenges"),b=window.rtbcbAdmin||window.rtbcbAjax;e.ajax({url:b.ajax_url,type:"POST",data:{action:"rtbcb_get_company_data",nonce:b.nonce},success:function(r){r.success&&(s.text(r.data.summary||""),l.empty(),(r.data.challenges||[]).forEach(function(r){l.append(e("<li />").text(r))}))}}),i.on("change",function(){i.is(":checked")?o.show():o.hide().val([])}),r.on("click",function(){const t=a.is(":checked")?1:0,s=i.is(":checked")&&o.val()||[],l=window.rtbcbAdmin?rtbcbAdmin.real_treasury_overview_nonce:b.nonce,d=b.ajax_url,u=performance.now(),v=rtbcbTestUtils.showLoading(r,"Generating...");n.show(),c.html("<p>Generating overview...</p>"),e.ajax({url:d,type:"POST",data:{action:"rtbcb_test_real_treasury_overview",include_portal:t,categories:s,nonce:l},success:function(t){if(t.success){const n=t.data,a=n.overview||"";rtbcbTestUtils.renderSuccess(c,a,u,{word_count:n.word_count,elapsed_time:n.elapsed,generated_at:n.generated}),e("#rtbcb-regenerate-real-treasury-overview").on("click",function(){r.trigger("click")}),e("#rtbcb-copy-real-treasury-overview").on("click",function(){rtbcbTestUtils.copyToClipboard(a)})}else rtbcbTestUtils.renderError(c,t.data.message||"Failed to generate overview",function(){r.trigger("click")})},error:function(){rtbcbTestUtils.renderError(c,"Request failed. Please try again.",function(){r.trigger("click")})},complete:function(){rtbcbTestUtils.hideLoading(r,v)}})}),t.on("click",function(){a.prop("checked",!1),i.prop("checked",!1),o.val([]).hide(),c.html(""),n.hide()})})}(jQuery);