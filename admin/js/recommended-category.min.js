!function(e){"use strict";e(document).ready(function(){const t=e("#rtbcb-generate-category-recommendation"),n=e("#rtbcb-category-recommendation-results"),r=e("#rtbcb-category-recommendation-card"),o=window.rtbcbAdmin||window.rtbcb_ajax;function c(){const a={action:"rtbcb_generate_category_recommendation",nonce:window.rtbcbAdmin?rtbcbAdmin.category_recommendation_nonce:o.nonce,extra_requirements:e("#rtbcb-extra-requirements").val()},i=rtbcbTestUtils.showLoading(t,"Generating...");r.show(),n.html("<p>Generating recommendation...</p>"),e.ajax({url:o.ajax_url,type:"POST",data:a,success:function(r){if(r.success){const o=r.data;window.rtbcbAdmin&&(rtbcbAdmin.company=rtbcbAdmin.company||{},rtbcbAdmin.company.recommended_category=o.recommended.key||o.recommended,e("#rtbcb-test-category").val(rtbcbAdmin.company.recommended_category));let c="<h2>"+e("<div/>").text(o.recommended.name||o.recommended.key).html()+"</h2>";o.reasoning&&(c+="<p><strong>Reasoning:</strong> "+e("<div/>").text(o.reasoning).html()+"</p>"),o.alternatives&&o.alternatives.length&&(c+="<p><strong>Alternatives:</strong></p><ul>",o.alternatives.forEach(function(t){c+="<li>"+e("<div/>").text(t.name||t.key).html(),t.reasoning&&(c+=" - "+e("<div/>").text(t.reasoning).html()),c+="</li>"}),c+="</ul>"),o.confidence&&(c+="<p><strong>Confidence:</strong> "+o.confidence+"%</p>"),o.implementation_roadmap&&(c+="<p><strong>Roadmap:</strong> "+e("<div/>").text(o.implementation_roadmap).html()+"</p>"),o.success_factors&&(c+="<p><strong>Success Factors:</strong> "+e("<div/>").text(o.success_factors).html()+"</p>"),n.html(c),e("#rtbcb-regenerate-category-recommendation").on("click",function(){t.trigger("click")}),e("#rtbcb-copy-category-recommendation").on("click",function(){rtbcbTestUtils.copyToClipboard(n.text())})}else{const e=r.data&&r.data.message?r.data.message:"Failed to generate recommendation.";rtbcbTestUtils.renderError(n,e,c)}},error:function(){rtbcbTestUtils.renderError(n,"Request failed. Please try again.",c)},complete:function(){rtbcbTestUtils.hideLoading(t,i)}})}t.on("click",function(e){e.preventDefault(),c()})})}(jQuery);