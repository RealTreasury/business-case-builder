# Prevent direct access to PHP files
<FilesMatch "\.php$">
    Order Deny,Allow
    Deny from all
    Allow from 127.0.0.1
</FilesMatch>

# Allow main plugin file
<Files "real-treasury-business-case-builder.php">
    Order Allow,Deny
    Allow from all
</Files>

# Protect sensitive directories
<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteRule ^(inc|admin|tests|vendor)/.*$ - [F,L]
</IfModule>

# Security headers for enhanced protection
<IfModule mod_headers.c>
    # Prevent clickjacking attacks
    Header always append X-Frame-Options SAMEORIGIN
    
    # Prevent MIME type sniffing
    Header always set X-Content-Type-Options nosniff
    
    # Enable XSS Protection
    Header always set X-XSS-Protection "1; mode=block"
    
    # Referrer Policy for privacy
    Header always set Referrer-Policy "strict-origin-when-cross-origin"
    
    # Content Security Policy (restrictive for plugin files)
    Header always set Content-Security-Policy "default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data:; font-src 'self'; connect-src 'self'"
</IfModule>

# Protect configuration and sensitive files
<FilesMatch "(composer\.(json|lock)|package\.(json|lock)|\.env|\.gitignore|\.gitattributes|phpunit\.xml|phpcs\.xml)$">
    Order Deny,Allow
    Deny from all
</FilesMatch>

# Disable server signature
ServerSignature Off

# Prevent access to backup and temporary files
<FilesMatch "\.(bak|config|sql|fla|psd|ini|log|sh|inc|swp|dist)$">
    Order Deny,Allow
    Deny from all
</FilesMatch>
