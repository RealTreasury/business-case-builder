(function(wp,window){if(!wp||!wp.element){return}const{createElement:createElement,useState:useState,useContext:useContext,createContext:createContext,useEffect:useEffect,Fragment:Fragment,Children:Children}=wp.element;const WizardContext=createContext();function WizardProvider({children:children}){const[isOpen,setIsOpen]=useState(false);const[currentStep,setCurrentStep]=useState(1);const handleOpen=()=>{setCurrentStep(1);setIsOpen(true)};const handleClose=()=>{setIsOpen(false);const url=new URL(window.location.href);url.searchParams.delete("rtbcb_wizard");window.history.replaceState({},"",url.toString())};window.closeBusinessCaseModal=handleClose;useEffect(()=>{if(window.location.pathname==="/rtbcb"){setCurrentStep(1);setIsOpen(true);return}const params=new URLSearchParams(window.location.search);if(params.get("rtbcb_wizard")){setCurrentStep(1);setIsOpen(true);return}const openBtn=document.getElementById("rtbcb-open-btn");const openWizard=e=>{e.preventDefault();const overlay=document.getElementById("rtbcbModalOverlay");if(overlay){const current=new URL(window.location.href);current.searchParams.set("rtbcb_wizard","1");window.history.pushState({},"",current.toString());handleOpen();return}const url=new URL("/rtbcb/",window.location.origin);url.searchParams.set("rtbcb_wizard","1");window.open(url.toString(),"_blank","noopener,noreferrer")};const closeBtn=document.getElementById("rtbcb-close-btn");openBtn&&openBtn.addEventListener("click",openWizard);closeBtn&&closeBtn.addEventListener("click",handleClose);return()=>{openBtn&&openBtn.removeEventListener("click",openWizard);closeBtn&&closeBtn.removeEventListener("click",handleClose)}},[]);useEffect(()=>{const overlay=document.getElementById("rtbcbModalOverlay");if(!overlay){return}if(isOpen){overlay.classList.add("active");document.body.style.overflow="hidden";if(window.businessCaseBuilder&&typeof window.businessCaseBuilder.reinitialize==="function"){window.businessCaseBuilder.reinitialize()}}else{overlay.classList.remove("active");document.body.style.overflow="";if(window.businessCaseBuilder&&typeof window.businessCaseBuilder.cancelPolling==="function"){window.businessCaseBuilder.cancelPolling()}}},[isOpen]);useEffect(()=>{const handleEsc=e=>{if(e.key==="Escape"&&isOpen){handleClose()}};document.addEventListener("keydown",handleEsc);return()=>document.removeEventListener("keydown",handleEsc)},[isOpen]);const value={currentStep:currentStep,setCurrentStep:setCurrentStep,isOpen:isOpen,open:handleOpen,close:handleClose};return createElement(WizardContext.Provider,{value:value},children)}function useWizard(){return useContext(WizardContext)}function Steps({children:children}){const{currentStep:currentStep}=useWizard();return createElement(Fragment,null,Children.map(children,(child,index)=>index+1===currentStep?child:null))}window.RTBCBWizardReact={WizardProvider:WizardProvider,useWizard:useWizard,Steps:Steps};function mountWizard(){const overlay=document.getElementById("rtbcbModalOverlay");if(!overlay||!wp||!wp.element){return}const markup=overlay.innerHTML;const tree=createElement(WizardProvider,null,createElement("div",{dangerouslySetInnerHTML:{__html:markup}}));if(typeof wp.element.render==="function"){wp.element.render(tree,overlay)}else if(typeof wp.element.createRoot==="function"){wp.element.createRoot(overlay).render(tree)}else{overlay.innerHTML=markup}if(window.businessCaseBuilder){window.businessCaseBuilder.form=document.getElementById("rtbcbForm");window.businessCaseBuilder.overlay=overlay;if(typeof window.businessCaseBuilder.cacheElements==="function"){window.businessCaseBuilder.cacheElements()}if(typeof window.businessCaseBuilder.bindEvents==="function"){window.businessCaseBuilder.bindEvents()}if(typeof window.businessCaseBuilder.initializePath==="function"){window.businessCaseBuilder.initializePath()}}}if(document.readyState==="loading"){document.addEventListener("DOMContentLoaded",mountWizard)}else{mountWizard()}})(window.wp||{},window);