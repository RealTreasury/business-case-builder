!function(e){const r="undefined"!=typeof wp&&wp.i18n&&wp.i18n.__?wp.i18n.__:e=>e;function t(e){if("string"!=typeof e)return!1;return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e.trim())}function n(e){return Array.isArray(e)?e.filter(e=>null!=e&&""!==String(e).trim()).length>0:null!=e&&""!==String(e).trim()}function i(e){return Array.isArray(e)&&e.length>0}function o(e,{form:i,forceRequired:o=!1}={}){const a=e.value.trim();let s="",l=!0,c=null;if("radio"===e.type){c=i?i.querySelectorAll(`input[name="${e.name}"]`):[];return Array.from(c).some(e=>e.checked)||(s=r("This field is required","rtbcb"),l=!1),{valid:l,message:s,group:c}}if(o||e.hasAttribute("required"))if("checkbox"===e.type){n(Array.from(i.querySelectorAll(`[name="${e.name}"]:checked`)).map(e=>e.value))||(s=r("This field is required","rtbcb"),l=!1)}else n(a)||(s=r("This field is required","rtbcb"),l=!1);return l&&"company_name"===e.name&&(s=function(e){return e?e.length<2?r("Company name must be at least 2 characters","rtbcb"):e.length>100?r("Company name must be less than 100 characters","rtbcb"):/^[^a-zA-Z]*$/.test(e)?r("Please enter a valid company name","rtbcb"):"":""}(a),s&&(l=!1)),l&&"email"===e.type&&a&&(t(a)||(s=r("Please enter a valid email address","rtbcb"),l=!1)),l&&"number"===e.type&&a&&(s=function(e){return e&&!Number.isFinite(Number(e))?r("Please enter a valid number","rtbcb"):""}(a),s&&(l=!1)),{valid:l,message:s}}const a={validateEmail:t,validateRequired:n,requirePainPoints:i,validateField:o,validateStep:function(e,{form:t,reportType:n,getStepFields:a}){const s=a&&a(e)||[];let l=!0,c=null;const u=[];if(s.includes("pain_points")){i(Array.from(t.querySelectorAll('input[name="pain_points[]"]:checked')).map(e=>e.value))||(c=r("Please select at least one challenge.","rtbcb"),l=!1)}for(const e of s){const r=t.querySelector(`[name="${e}"]`);if(!r)continue;if("basic"===n&&r.closest(".rtbcb-enhanced-only"))continue;if("enhanced"===n&&r.closest(".rtbcb-enhanced-only")&&!r.hasAttribute("required"))continue;const{valid:i}=o(r,{form:t,forceRequired:!0});if(!i){l=!1;const t=r.closest(".rtbcb-field"),n=t?t.querySelector("label"):null;u.push(n?n.textContent.trim():e)}}return{valid:l,stepError:c,fieldErrors:u}},validateFormData:function(e,{form:o,reportType:a,totalSteps:s,getStepFields:l}){const c=r=>{if("function"==typeof e.get)return e.get(r);for(const[t,n]of e.entries())if(t===r)return n;return null},u=r=>{if("function"==typeof e.getAll){const t=e.getAll(r);return Array.isArray(t)?t:[]}const t=[];for(const[n,i]of e.entries())n===r&&t.push(i);return t},f=new Set,d=new Set;for(let e=1;e<=s;e++){(l&&l(e)||[]).forEach(e=>{const r=e.replace(/\[\]$/,"");f.add(r),(e.endsWith("[]")||"pain_points"===r)&&d.add(r)})}"basic"!==a&&["hours_reconciliation","hours_cash_positioning","num_banks","ftes"].forEach(e=>{o.querySelector(`[name="${e}"]`)&&f.add(e)});for(const e of f){if("pain_points"===e){if(!i(u("pain_points[]").filter(e=>e)))throw new Error(r("Please select at least one challenge.","rtbcb"));continue}if(o?o.querySelector(`[name="${e}"]`)||o.querySelector(`[name="${e}[]"]`):null){if(d.has(e)){if(!n(u(`${e}[]`).filter(e=>e)))throw new Error(`${r("Missing required field:","rtbcb")} ${e.replace("_"," ")}`);continue}if(!n(c(e)))throw new Error(`${r("Missing required field:","rtbcb")} ${e.replace("_"," ")}`)}}if(f.has("email")){if(!t(c("email")))throw new Error(r("Please enter a valid email address","rtbcb"))}if("basic"!==a){const e=["hours_reconciliation","hours_cash_positioning","num_banks","ftes"];for(const t of e)if(f.has(t)){const e=parseFloat(c(t));if(isNaN(e)||e<=0)throw new Error(`${t.replace("_"," ")} ${r("must be a positive number","rtbcb")}`)}}}};"undefined"!=typeof module&&module.exports?module.exports=a:e.RTBCBWizardValidation=a}("undefined"!=typeof window?window:globalThis);